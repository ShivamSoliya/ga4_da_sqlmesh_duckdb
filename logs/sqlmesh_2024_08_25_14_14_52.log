2024-08-25 14:14:52,645 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:301)
2024-08-25 14:14:53,082 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:301)
2024-08-25 14:14:53,146 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0001_init' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0001_init.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,151 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0002_remove_identify' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0002_remove_identify.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,151 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0003_move_batch_size' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0003_move_batch_size.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,151 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0004_environmnent_add_finalized_at' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0004_environmnent_add_finalized_at.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,152 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0005_create_seed_table' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0005_create_seed_table.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,154 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0006_change_seed_hash' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0006_change_seed_hash.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,154 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0007_env_table_info_to_kind' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0007_env_table_info_to_kind.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,155 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0008_create_intervals_table' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0008_create_intervals_table.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,158 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0009_remove_pre_post_hooks' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0009_remove_pre_post_hooks.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,159 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0010_seed_hash_batch_size' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0010_seed_hash_batch_size.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,159 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0011_add_model_kind_name' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0011_add_model_kind_name.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,160 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0012_update_jinja_expressions' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0012_update_jinja_expressions.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,161 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0013_serde_using_model_dialects' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0013_serde_using_model_dialects.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,162 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0014_fix_dev_intervals' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0014_fix_dev_intervals.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,163 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0015_environment_add_promoted_snapshot_ids' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0015_environment_add_promoted_snapshot_ids.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,164 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0016_fix_windows_path' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0016_fix_windows_path.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,165 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0017_fix_windows_seed_path' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0017_fix_windows_seed_path.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,166 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0018_rename_snapshot_model_to_node' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0018_rename_snapshot_model_to_node.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,167 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0019_add_env_suffix_target' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0019_add_env_suffix_target.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,169 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0020_remove_redundant_attributes_from_dbt_models' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0020_remove_redundant_attributes_from_dbt_models.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,170 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0021_fix_table_properties' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0021_fix_table_properties.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,171 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0022_move_project_to_model' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0022_move_project_to_model.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,173 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0023_fix_added_models_with_forward_only_parents' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0023_fix_added_models_with_forward_only_parents.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,174 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0024_replace_model_kind_name_enum_with_value' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0024_replace_model_kind_name_enum_with_value.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,175 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0025_fix_intervals_and_missing_change_category' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0025_fix_intervals_and_missing_change_category.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,176 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0026_remove_dialect_from_seed' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0026_remove_dialect_from_seed.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,177 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0027_minute_interval_to_five' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0027_minute_interval_to_five.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,178 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0028_add_plan_dags_table' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0028_add_plan_dags_table.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,179 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0029_generate_schema_types_using_dialect' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0029_generate_schema_types_using_dialect.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,180 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0030_update_unrestorable_snapshots' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0030_update_unrestorable_snapshots.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,182 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0031_remove_dbt_target_fields' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0031_remove_dbt_target_fields.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,183 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0032_add_sqlmesh_version' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0032_add_sqlmesh_version.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,183 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0033_mysql_fix_blob_text_type' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0033_mysql_fix_blob_text_type.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,184 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0034_add_default_catalog' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0034_add_default_catalog.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,188 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0035_add_catalog_name_override' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0035_add_catalog_name_override.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,189 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0036_delete_plan_dags_bug_fix' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0036_delete_plan_dags_bug_fix.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,190 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0037_remove_dbt_is_incremental_macro' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0037_remove_dbt_is_incremental_macro.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,191 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0038_add_expiration_ts_to_snapshot' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0038_add_expiration_ts_to_snapshot.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,192 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0039_include_environment_in_plan_dag_spec' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0039_include_environment_in_plan_dag_spec.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,193 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0040_add_previous_finalized_snapshots' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0040_add_previous_finalized_snapshots.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,194 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0041_remove_hash_raw_query_attribute' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0041_remove_hash_raw_query_attribute.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,195 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0042_trim_indirect_versions' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0042_trim_indirect_versions.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,196 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0043_fix_remove_obsolete_attributes_in_plan_dags' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0043_fix_remove_obsolete_attributes_in_plan_dags.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,197 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0044_quote_identifiers_in_model_attributes' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0044_quote_identifiers_in_model_attributes.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,197 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0045_move_gateway_variable' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0045_move_gateway_variable.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,199 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0046_add_batch_concurrency' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0046_add_batch_concurrency.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,199 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0047_change_scd_string_to_column' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0047_change_scd_string_to_column.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,199 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0048_drop_indirect_versions' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0048_drop_indirect_versions.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,200 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0049_replace_identifier_with_version_in_seeds_table' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0049_replace_identifier_with_version_in_seeds_table.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,207 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0050_drop_seeds_table' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0050_drop_seeds_table.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,207 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0051_rename_column_descriptions' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0051_rename_column_descriptions.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,208 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0052_add_normalize_name_in_environment_naming_info' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0052_add_normalize_name_in_environment_naming_info.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,210 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0053_custom_model_kind_extra_attributes' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0053_custom_model_kind_extra_attributes.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,211 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0054_fix_trailing_comments' from '/home/shivam/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0054_fix_trailing_comments.py'> (engine_adapter.py:1007)
2024-08-25 14:14:53,211 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Fetching environments (engine_adapter.py:1013)
2024-08-25 14:14:53,211 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Migrating snapshot rows... (engine_adapter.py:1030)
2024-08-25 14:14:53,212 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - No changes to snapshots detected (engine_adapter.py:1023)
2024-08-25 14:14:54,122 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema memory.sqlmesh__sqlmesh_example (evaluator.py:273)
2024-08-25 14:14:54,122 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1916)
2024-08-25 14:14:54,123 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1916)
2024-08-25 14:14:54,125 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE (table_catalog = 'memory' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__latest_session__1360470533', 'sqlmesh_example__gcs_load__3424733010__temp', 'sqlmesh_example__latest_session__1360470533__temp', 'sqlmesh_example__gcs_load__3424733010') (base.py:1916)
2024-08-25 14:14:54,158 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'memory.sqlmesh__sqlmesh_example' (evaluator.py:888)
2024-08-25 14:14:54,159 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "memory"."sqlmesh__sqlmesh_example" (base.py:1916)
2024-08-25 14:14:54,159 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'memory.sqlmesh__sqlmesh_example.sqlmesh_example__gcs_load__3424733010__temp' (evaluator.py:1580)
2024-08-25 14:14:54,165 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__gcs_load__3424733010__temp" AS SELECT * FROM READ_PARQUET(['~/dev/mnt/20210131/*']) AS "_q_0" (base.py:1916)
2024-08-25 14:14:54,556 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'memory.sqlmesh__sqlmesh_example.sqlmesh_example__gcs_load__3424733010' (evaluator.py:1580)
2024-08-25 14:14:54,560 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__gcs_load__3424733010" AS SELECT * FROM READ_PARQUET(['~/dev/mnt/20210131/*']) AS "_q_0" (base.py:1916)
2024-08-25 14:14:55,890 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'memory.sqlmesh__sqlmesh_example.sqlmesh_example__latest_session__1360470533__temp' (evaluator.py:1580)
2024-08-25 14:14:55,903 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__latest_session__1360470533__temp" AS SELECT DISTINCT "event_date" AS "event_date", "user_pseudo_id" AS "user_pseudo_id", FIRST_VALUE((SELECT "ep"."key"."value"."int_value" WHERE "ep"."key"."key" = 'ga_session_id' LIMIT 1)) OVER "userwindow" AS "ga_session_id", FIRST_VALUE((SELECT "ep"."key"."value"."int_value" WHERE "ep"."key"."key" = 'ga_session_number' LIMIT 1)) OVER "userwindow" AS "ga_session_number" FROM "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__gcs_load__3424733010" AS "gcs_load", UNNEST("event_params") AS "ep"("key") WHERE "user_pseudo_id" IN ('1026454.4271112504', '1031480.8260955562', '1037360.4939379761') WINDOW "userwindow" AS (PARTITION BY "user_pseudo_id" ORDER BY "event_timestamp" DESC) (base.py:1916)
2024-08-25 14:14:56,282 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'memory.sqlmesh__sqlmesh_example.sqlmesh_example__latest_session__1360470533' (evaluator.py:1580)
2024-08-25 14:14:56,293 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__latest_session__1360470533" AS SELECT DISTINCT "event_date" AS "event_date", "user_pseudo_id" AS "user_pseudo_id", FIRST_VALUE((SELECT "ep"."key"."value"."int_value" WHERE "ep"."key"."key" = 'ga_session_id' LIMIT 1)) OVER "userwindow" AS "ga_session_id", FIRST_VALUE((SELECT "ep"."key"."value"."int_value" WHERE "ep"."key"."key" = 'ga_session_number' LIMIT 1)) OVER "userwindow" AS "ga_session_number" FROM "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__gcs_load__3424733010" AS "gcs_load", UNNEST("event_params") AS "ep"("key") WHERE "user_pseudo_id" IN ('1026454.4271112504', '1031480.8260955562', '1037360.4939379761') WINDOW "userwindow" AS (PARTITION BY "user_pseudo_id" ORDER BY "event_timestamp" DESC) (base.py:1916)
2024-08-25 14:14:57,634 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COPY "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__latest_session__1360470533" TO '~/dev/mnt/output/20240825_141457_latest_session.csv' (base.py:1916)
2024-08-25 14:15:01,248 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"memory"."sqlmesh_example"."gcs_load": 51600983> (evaluator.py:487)
2024-08-25 14:15:01,253 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-07-01 00:00:00+00:00, 2024-08-25 00:00:00+00:00) into memory.sqlmesh__sqlmesh_example.sqlmesh_example__gcs_load__3424733010' (evaluator.py:517)
2024-08-25 14:15:01,253 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'memory.sqlmesh__sqlmesh_example.sqlmesh_example__gcs_load__3424733010' (evaluator.py:1552)
2024-08-25 14:15:01,254 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__gcs_load__3424733010" AS SELECT * FROM READ_PARQUET(['~/dev/mnt/20210131/*']) AS "_q_0" (base.py:1916)
2024-08-25 14:15:01,727 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1719792000000, 1724544000000) for snapshot SnapshotId<"memory"."sqlmesh_example"."gcs_load": 51600983> (engine_adapter.py:603)
2024-08-25 14:15:01,746 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"memory"."sqlmesh_example"."latest_session": 1700471187> (evaluator.py:487)
2024-08-25 14:15:01,757 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-07-01 00:00:00+00:00, 2024-08-25 00:00:00+00:00) into memory.sqlmesh__sqlmesh_example.sqlmesh_example__latest_session__1360470533' (evaluator.py:517)
2024-08-25 14:15:01,757 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'memory.sqlmesh__sqlmesh_example.sqlmesh_example__latest_session__1360470533' (evaluator.py:1552)
2024-08-25 14:15:01,759 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__latest_session__1360470533" ("event_date", "user_pseudo_id", "ga_session_id", "ga_session_number") AS SELECT DISTINCT "event_date" AS "event_date", "user_pseudo_id" AS "user_pseudo_id", FIRST_VALUE((SELECT "ep"."key"."value"."int_value" WHERE "ep"."key"."key" = 'ga_session_id' LIMIT 1)) OVER "userwindow" AS "ga_session_id", FIRST_VALUE((SELECT "ep"."key"."value"."int_value" WHERE "ep"."key"."key" = 'ga_session_number' LIMIT 1)) OVER "userwindow" AS "ga_session_number" FROM "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__gcs_load__3424733010" AS "gcs_load", UNNEST("event_params") AS "ep"("key") WHERE "user_pseudo_id" IN ('1026454.4271112504', '1031480.8260955562', '1037360.4939379761') WINDOW "userwindow" AS (PARTITION BY "user_pseudo_id" ORDER BY "event_timestamp" DESC) (base.py:1916)
2024-08-25 14:15:02,956 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1719792000000, 1724544000000) for snapshot SnapshotId<"memory"."sqlmesh_example"."latest_session": 1700471187> (engine_adapter.py:603)
2024-08-25 14:15:02,972 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'prod' (common.py:123)
2024-08-25 14:15:03,024 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"memory"."sqlmesh_example"."gcs_load": 51600983> (common.py:228)
2024-08-25 14:15:03,028 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"memory"."sqlmesh_example"."latest_session": 1700471187> (common.py:228)
2024-08-25 14:15:03,036 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'memory.sqlmesh_example' (evaluator.py:888)
2024-08-25 14:15:03,036 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "memory"."sqlmesh_example" (base.py:1916)
2024-08-25 14:15:03,037 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'memory.sqlmesh_example.gcs_load' to point at table 'memory.sqlmesh__sqlmesh_example.sqlmesh_example__gcs_load__3424733010' (evaluator.py:1143)
2024-08-25 14:15:03,038 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "memory"."sqlmesh_example"."gcs_load" AS SELECT * FROM "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__gcs_load__3424733010" (base.py:1916)
2024-08-25 14:15:03,469 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'memory.sqlmesh_example.latest_session' to point at table 'memory.sqlmesh__sqlmesh_example.sqlmesh_example__latest_session__1360470533' (evaluator.py:1143)
2024-08-25 14:15:03,469 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "memory"."sqlmesh_example"."latest_session" AS SELECT * FROM "memory"."sqlmesh__sqlmesh_example"."sqlmesh_example__latest_session__1360470533" (base.py:1916)
2024-08-25 14:15:04,899 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'prod' (common.py:201)
2024-08-25 14:15:04,932 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
